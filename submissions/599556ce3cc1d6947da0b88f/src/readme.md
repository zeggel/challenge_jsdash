Explanation of approach for JS Challenge Summer 2017: JSDash



At each frame, Script scans the screen, analyzes the field and makes
a decision to move.


1. Navigation.

For path finding, Script used Wave Algorithm.
All FINISH points marked with 0.
Until START point reached on every step (i), all unmarked neighbors of
cells marked with (i) with next (i+1) label. 
Example:

########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O A O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
# O::::+:O:: ::*:::::  ::::O:::::  : ::#
#::O: :: :: O ::::: *:::::OO::  :OO::: #
#: :  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+:::* ::O:: O  + ::: : :* O::+O : :*::#
# : ::O  ++**:  ::  + ::O:O:*O :: ++::*#
#   ++:OO:*::OO::: :*O:+::O:::: :  *: :#
# :O+O+O: +::::::O::::+*:::  :+O:O+::* #
# ::::::::::+  :+: + : *OO:++:+:++  *: #
# +  +:O :::::O:  :+O::::::+  :  :*::::#
# * /: +OOO  :O:O:O+:+:: O::: :  :::* :#
#+::::+::+:   :::+:  : :::: :*:: :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:0 :O O::+ 0:: :  : :0+:+: ::  :::   :#
#O:: +:::: O:: 0:O0:0O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :0O:O 0   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:0 : :O A O+: +:::+::: : ::O:::#
#:0:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : 0:O: :::O+#
# O::::+:O:: ::0:::::  ::::O:::::  : ::#
#::O: :: :: O ::::: 0:::::OO::  :OO::: #
#: :  ::::00:    /0+:  :+:::0:O0:O:: ::#
#+:::0 ::O:: O  + ::: : :0 O::+O : :0::#
# : ::O  ++00:  ::  + ::O:O:0O :: ++::0#
#   ++:OO:0::OO::: :0O:+::O:::: :  0: :#
# :O+O+O: +::::::O::::+0:::  :+O:O+::0 #
# ::::::::::+  :+: + : 0OO:++:+:++  0: #
# +  +:O :::::O:  :+O::::::+  :  :0::::#
# 0 /: +OOO  :O:O:O+:+:: O::: :  :::0 :#
#+::::+::+:   :::+:  : :::: :0:: :: :: #
# ++:::O::+++::   /0:: +  :::0     O:: #
#: :+O0OO:+:::   :::  :::::O:: 00 0O   #
########################################
                    
########################################
#101:O O::+101:1: 1:110+:+: ::  :::   :#
#O1: +:::: O1:101O010O++ OOO  +O:: ::+:#
#::+: : + :O: :1 :O O::: 10O:O101  ::+:#
#:+:::: :1:::: +  :OO:O::++O ::O:::  OO#
# O::::O101: :O A O+: +:::+::: : ::O:::#
#101O:O: 1: : ::::+::: :: : :+ ::::: ::#
# 1:++: : : :: 1::O :: : : :101O: :::O+#
# O::::+:O:: :101:::1  ::::O:1:::  : ::#
#::O: :: :11O :1::1101::::OO1: 1:OO::: #
#: : 1:::1001    /0+1  :+1:101O01O::1::#
#+::101::O111O  + 1:: : 101O1:+O : 1011#
# : :1O  ++001  ::  + ::O1O10O :: ++110#
#   ++:OO:011OO::: 10O:+::O:1:: : 10111#
# :O+O+O: +::::::O::1:+01::  :+O:O+1101#
# ::::::::::+  :+: + :10OO:++:+:++1101 #
# +  +:O :::::O:  :+O::1:::+  :  :011::#
#101/: +OOO  :O:O:O+:+:: O:::1:  ::101:#
#+1:::+::+:   :::+:1 : :::: 101: :: 1: #
# ++::1O::+++::   /01: +  ::10111 1O:: #
#: :+O0OO:+:::   ::1  :::::O:110010O   #
########################################
                    
########################################
#1012O O::+101212212110+:+: ::  :::   :#
#O12 +:::: O12101O010O++ OOO  +O2: ::+:#
#:2+: : +2:O2 212:O2O:::210O:O1012 ::+:#
#:+:::: 212::: +  :OO:O::++O :2O2::  OO#
#2O2:::O1012 :O A O+: +:::+::: : ::O:::#
#101O:O:212 : :2::+::: :: : 2+2::::: ::#
#212++: :2: ::212:O 2: : : 2101O: :::O+#
# O::::+:O22 21012221  ::::O2122:  : ::#
#::O:2:: 211O 212211012::2OO12212OO:2: #
#: :212:210012   /0+12 :+12101O01O:2122#
#+:21012:O111O  +2122 :2101O12+O2:21011#
# : 21O  ++0012 ::22+ ::O1O10O :: ++110#
#   ++:OO1011OO:::210O:+22O212: :210111#
# :O+O+O:2+22::::O:212+012: 2:+O:O+1101#
# ::::::::::+  :+: +2210OO:++:+:++11012#
#2+2 +:O :::::O:  :+O:212::+ 2: 210112:#
#101/: +OOO  :O:O:O+:+:2 O::212  211012#
#+12::+::+:   :::+212: ::::210122:2212 #
# ++:21O::+++::   /012 +  :21011121O2: #
#: :+O0OO:+:::   :212 :::::O2110010O   #
########################################
    
########################################
#1012O O::+101212212110+:+: ::  3::   :#
#O123+:::3 O12101O010O++3OOO  +O23 ::+:#
#32+: : +23O232123O2O::3210O:O10123::+:#
#3+3:::321233:3+3 :OO:O:3++O 32O23:  OO#
#2O23::O10123:O3A O+: +:::+:3:3:3::O:::#
#101O:O32123: 323:+:3: :: :32+23:::: ::#
#212++: 3233:32123O323 : :32101O: :::O+#
#3O3:3:+:O2232101222123::3:O21223  :3::#
#::O323:3211O3212211012332OO12212OO3233#
#: 32123210012323/0+1233+12101O01O32122#
#+3210123O111O33+2122332101O12+O2321011#
# :321O  ++00123:322+ :3O1O10O :33++110#
#   ++:OO1011OO::3210O:+22O2123 3210111#
# :O+O+O32+223:::O3212+0123323+O:O+1101#
#3:3:::::3:3+  :+: +2210OO:++3+:++11012#
#2+23+:O :::::O:  :+O32123:+32332101123#
#101/: +OOO  :O:O:O+3+323O:321233211012#
#+1233+::+:   :::+2123 3::3210122322123#
# ++321O::+++::   /0123+  321011121O23 #
#: :+O0OO:+:::   32123:::::O2110010O3  #
########################################
                    
Beginning from start point and moving to lower mark on every step,
Script reached NEAREST finish point.


2. Modification for Hunting.

While collecting diamonds, Script gets score immediately when reached finish
point. Main idea for hunting method - use of non zero marks for wave
algorithm finish points. It means Script will get score with some
delay after reaching ambush point.
Delay estimation consists of number of animal steps to reach crash point
and number of steps to walk for reward after successful hunting.
In this example, mark value will be E=steps+height

########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::  :: : : :  : : :::O+#
# O::::+:                            ::#
#::O: ::                             : #
#: :  :::                            ::#
#+:::* ::                            ::#
# : ::O                              :*#
#  ++:OO                              :#
# :O+O+O:                            * #
# ::::::::::+  A       *OO:++:+:++  *: #
# +  +:O :             ::::::::     :::#
# * /: +OOO  EO1                    * :#
#+::::+::+:   :2                    :: #
# ++:::O::+++::3                    :: #
#: :+O*OO:+::: x54321/                 #
########################################

Depending on situation, Script uses next estimation methods:

E = 0 (nearest ambush point)
E = steps?height (quick hunting)
E = steps (hunting)
E = steps+height (hunting while collecting diamonds)

3. Modification for Careful moving.

While marking cells during wave algorithm, Script increases marks for
dirt, which keeps stones from falling. 
This cells still passible, but moving across them has a higher cost.
It makes move possible without unnecessary stone drops.
In this example, Scrip will bypass dirt point.
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A    :: :: O ::::: *:::::OO::  :OO::: #
#O::  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+ ::  ::O:: O  + ::: : :* O::+O : :*::#
#*  ::O  ++**:  ::  + ::O:O:*O :: ++::*#
#:  ++:OO:*::OO::: :*O:+::O:::: :  *: :#
# :O+O+O: +::::::O::::+*:::  :+O:O+::* #
# ::::::::::+  :+: + : *OO:++:+:++  *: #
# +  +:O :::::O:  :+O::::::+  :  :*::::#
# *  : +OOO  :O:O:O+:+:: O::: :  :::* :#
#+::::+::+:   :::+:  : :::: :*:: :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                                       
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A    :: :: O ::::: *:::::OO::  :OO::: #
#O::  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+ ::  ::O:: O  + ::: : :* O::+O : :*::#
#*1 ::O  ++**:  ::  + ::O:O:*O :: ++::*#
#1  ++:OO:*::OO::: :*O:+::O:::: :  *: :#
# :O+O+O: +::::::O::::+*:::  :+O:O+::* #
# ::::::::::+  :+: + : *OO:++:+:++  *: #
# +  +:O :::::O:  :+O::::::+  :  :*::::#
#   : +OOO  :O:O:O+:+:: O::: :   :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A    :: :: O ::::: *:::::OO::  :OO::: #
#O::  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+2::  ::O:: O  + ::: : :* O::+O : :*::#
#*12::O  ++**:  ::  + ::O:O:*O :: ++::*#
#12 ++:OO:*::OO::: :*O:+::O:::: :  *: :#
#2:O+O+O: +::::::O::::+*:::  :+O:O+::* #
# ::::::::::+  :+: + : *OO:++:+:++  *: #
# +  +:O :::::O:  :+O::::::+  :  :*::::#
#   : +OOO  :O:O:O+:+:: O::: :   :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A    :: :: O ::::: *:::::OO::  :OO::: #
#O4:  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+23:  ::O:: O  + ::: : :* O::+O : :*::#
#*123:O  ++**:  ::  + ::O:O:*O :: ++::*#
#123++:OO:*::OO::: :*O:+::O:::: :  *: :#
#23O+O+O: +::::::O::::+*:::  :+O:O+::* #
#3::::::::::+  :+: + : *OO:++:+:++  *: #
# +  +:O :::::O:  :+O::::::+  :  :*::::#
#   : +OOO  :O:O:O+:+:: O::: :   :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A    :: :: O ::::: *:::::OO::  :OO::: #
#O64  ::::**:    /*+:  :+:::*:O*:O:: ::#
#+234  ::O:: O  + ::: : :* O::+O : :*::#
#*1234O  ++**:  ::  + ::O:O:*O :: ++::*#
#123++:OO:*::OO::: :*O:+::O:::: :  *: :#
#23O+O+O: +::::::O::::+*:::  :+O:O+::* #
#34:::::::::+  :+: + : *OO:++:+:++  *: #
#4+  +:O :::::O:  :+O::::::+  :  :*::::#
#   : +OOO  :O:O:O+:+:: O::: :   :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#    ::+:O:: ::*:::::  ::::O:::::  : ::#
#A 5  :: :: O ::::: *:::::OO::  :OO::: #
#O645 ::::**:    /*+:  :+:::*:O*:O:: ::#
#+2345 ::O:: O  + ::: : :* O::+O : :*::#
#*1234O  ++**:  ::  + ::O:O:*O :: ++::*#
#123++:OO:*::OO::: :*O:+::O:::: :  *: :#
#23O+O+O: +::::::O::::+*:::  :+O:O+::* #
#346::::::::+  :+: + : *OO:++:+:++  *: #
#4+  +:O :::::O:  :+O::::::+  :  :*::::#
#5  : +OOO  :O:O:O+:+:: O::: :   :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################
                    
########################################
#:* :O O::+ *:: :  : :*+:+: ::  :::   :#
#O:: +:::: O:: *:O*:*O++ OOO  +O:: ::+:#
#::+: : + :O: :: :O O::: :*O:O *   ::+:#
#:+:::: : :::: +  :OO:O::++O ::O:::  OO#
# O::::O:* : :O   O+: +:::+::: : ::O:::#
#:*:O:O: :: : ::::+::: :: : :+ ::::: ::#
# ::++: : : :: :::O :: : : : *:O: :::O+#
#  6 ::+:O:: ::*:::::  ::::O:::::  : ::#
#A656 :: :: O ::::: *:::::OO::  :OO::: #
#O8456::::**:    /*+:  :+:::*:O*:O:: ::#
#+23456::O:: O  + ::: : :* O::+O : :*::#
#*1234O  ++**:  ::  + ::O:O:*O :: ++::*#
#123++:OO:*::OO::: :*O:+::O:::: :  *: :#
#23O+O+O: +::::::O::::+*:::  :+O:O+::* #
#346::::::::+  :+: + : *OO:++:+:++  *: #
#4+  +:O :::::O:  :+O::::::+  :  :*::::#
#56  : +OOO  :O:O:O+:+:: O::: :  :::* :#
#+::::+::+:  :::+:  : :::: :*::  :: :: #
# ++:::O::+++::   /*:: +  :::*     O:: #
#: :+O*OO:+:::   :::  :::::O:: ** *O   #
########################################

4. Anti-looping.

Script remembers last move. When script few times walks by his own
footprints, it means script lost his way. In this case, Script should
change his mode.


5. Hot streaks. 

Script makes hot streaks choosing the shortest way to collect next diamond.
To make longer hot streak Script moves diamonds together by dropping them
down. Just clearing the dirt prevents falling of diamonds.
To make no breaks, Script walks to left field side before it starts 
collecting diamonds.


6. Common algorithm. 

Script performs next actions:

1. Drop down few diamonds to clear some space.
2. Main loop:
2.1. Hunting for butterflies.
2.2. If can?t found places for hunting, trying to open locked butterflies.
2.3. If all butterflies are unlocked, trying to create new trap for hunting
     (clear dirt in the right place).
2.4. If no success, drop down few diamonds.
3. Drop down all diamonds in higher field area.
4. Collecting diamonds.


                    

                    
